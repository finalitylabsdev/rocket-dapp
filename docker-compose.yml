services:
  rocket-web:
    container_name: rocket-web
    build:
      context: .
      dockerfile: Dockerfile
      args:
        VITE_SUPABASE_URL: ${VITE_SUPABASE_URL:-}
        VITE_SUPABASE_PUBLISHABLE_KEY: ${VITE_SUPABASE_PUBLISHABLE_KEY:-}
        VITE_SUPABASE_ANON_KEY: ${VITE_SUPABASE_ANON_KEY:-}
        VITE_SPEC_DEV_FAST_ECONOMY: ${VITE_SPEC_DEV_FAST_ECONOMY:-true}
        VITE_SPEC_WHITELIST_BONUS_FLUX: ${VITE_SPEC_WHITELIST_BONUS_FLUX:-300}
        VITE_SPEC_DAILY_CLAIM_FLUX: ${VITE_SPEC_DAILY_CLAIM_FLUX:-20}
        VITE_SPEC_FAUCET_INTERVAL_SECONDS: ${VITE_SPEC_FAUCET_INTERVAL_SECONDS:-5}
        VITE_SPEC_BOX_PRICE_MULTIPLIER: ${VITE_SPEC_BOX_PRICE_MULTIPLIER:-0.4}
        VITE_FEATURE_DEX_TRADING_ENABLED: ${VITE_FEATURE_DEX_TRADING_ENABLED:-false}
    ports:
      - "127.0.0.1:3456:80"
    restart: unless-stopped

  rocket-sim:
    container_name: rocket-sim
    profiles:
      - sim
    build:
      context: .
      dockerfile: deploy/sim/Dockerfile
    environment:
      VITE_SUPABASE_URL: ${VITE_SUPABASE_URL:-}
      VITE_SUPABASE_PUBLISHABLE_KEY: ${VITE_SUPABASE_PUBLISHABLE_KEY:-}
      VITE_SUPABASE_ANON_KEY: ${VITE_SUPABASE_ANON_KEY:-}
      SUPABASE_SERVICE_ROLE_KEY: ${SUPABASE_SERVICE_ROLE_KEY:-}
      VITE_SPEC_WHITELIST_BONUS_FLUX: ${VITE_SPEC_WHITELIST_BONUS_FLUX:-}
      VITE_SPEC_WHITELIST_ETH: ${VITE_SPEC_WHITELIST_ETH:-}
      VITE_SPEC_DAILY_CLAIM_FLUX: ${VITE_SPEC_DAILY_CLAIM_FLUX:-}
      VITE_SPEC_FAUCET_INTERVAL_SECONDS: ${VITE_SPEC_FAUCET_INTERVAL_SECONDS:-}
      VITE_ETH_LOCK_RECIPIENT: ${VITE_ETH_LOCK_RECIPIENT:-}
      VITE_SIWE_URI: ${VITE_SIWE_URI:-}
      VITE_SIWE_DOMAIN: ${VITE_SIWE_DOMAIN:-}
      SIM_WALLET_PRIVATE_KEYS: ${SIM_WALLET_PRIVATE_KEYS:-}
      SIM_WALLET_SOURCE: ${SIM_WALLET_SOURCE:-env}
      SIM_SUPABASE_SERVICE_ROLE_KEY: ${SIM_SUPABASE_SERVICE_ROLE_KEY:-}
      SIM_MANAGED_WALLETS_ENCRYPTION_KEY: ${SIM_MANAGED_WALLETS_ENCRYPTION_KEY:-}
      SIM_MANAGED_WALLET_TARGET_COUNT: ${SIM_MANAGED_WALLET_TARGET_COUNT:-0}
      SIM_MANAGED_WALLET_KID: ${SIM_MANAGED_WALLET_KID:-sim-local-v1}
      SIM_MANAGED_WALLET_GENERATION_MIN_INTERVAL_MS: ${SIM_MANAGED_WALLET_GENERATION_MIN_INTERVAL_MS:-120000}
      SIM_MANAGED_WALLET_GENERATION_MAX_INTERVAL_MS: ${SIM_MANAGED_WALLET_GENERATION_MAX_INTERVAL_MS:-420000}
      SIM_IMPORT_ENV_WALLETS_TO_SUPABASE: ${SIM_IMPORT_ENV_WALLETS_TO_SUPABASE:-true}
      SIM_AUTO_CONFIRM_ETH_LOCK: ${SIM_AUTO_CONFIRM_ETH_LOCK:-true}
      SIM_ETH_LOCK_TO_ADDRESS: ${SIM_ETH_LOCK_TO_ADDRESS:-}
      SIM_ETH_LOCK_AMOUNT_WEI: ${SIM_ETH_LOCK_AMOUNT_WEI:-}
      SIM_CHAIN_ID: ${SIM_CHAIN_ID:-1}
      SIM_SIWE_URI: ${SIM_SIWE_URI:-}
      SIM_SIWE_DOMAIN: ${SIM_SIWE_DOMAIN:-}
      SIM_BOX_TIER_IDS: ${SIM_BOX_TIER_IDS:-}
      SIM_LOOP_INTERVAL_MS: ${SIM_LOOP_INTERVAL_MS:-45000}
      SIM_INITIAL_SPREAD_MS: ${SIM_INITIAL_SPREAD_MS:-15000}
      SIM_MAX_BOX_OPENS_PER_CYCLE: ${SIM_MAX_BOX_OPENS_PER_CYCLE:-1}
      SIM_DRY_RUN: ${SIM_DRY_RUN:-false}
      SIM_RUN_ONCE: ${SIM_RUN_ONCE:-false}
      SIM_BOOTSTRAP_ONLY: ${SIM_BOOTSTRAP_ONLY:-false}
      SIM_USER_AGENT: ${SIM_USER_AGENT:-entropy-sim/1.0}
    restart: unless-stopped
